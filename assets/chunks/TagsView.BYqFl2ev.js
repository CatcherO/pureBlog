import{d as R,p,ad as U,h as k,v as C,Y as E,q as V,c as l,o as n,j as o,G as B,n as $,F as h,B as w,b as j,T as N,w as O,a as _,t as v,e as T,N as x,k as b,g as L,P as z,_ as F}from"./framework.Dw9xXWbv.js";import{d as I,T as q}from"./theme.DB_jWPTw.js";function D(g){if(!g||g.length===0)return{};const r={};return g.forEach(u=>{const t=u.tags;t&&t.forEach(d=>{r[d]||(r[d]=[]),r[d].push(u)})}),r}const G={key:0,class:"loading"},M={key:1,class:"no-posts"},Y={key:2,class:"tags-container"},A={class:"tags-wrapper"},H={class:"tag-header"},J={class:"tag-count"},K={class:"posts-container"},Q=["href"],W={class:"post-container"},X={class:"date"},Z={key:0,class:"no-posts"},ee={key:"all",class:"content-wrapper"},se={class:"posts-by-tag"},te={class:"tag-title"},oe={class:"tag-posts"},ae=["href"],ne={class:"post-container"},le={class:"date"},ie={key:0,class:"no-posts"},ce=R({__name:"TagsView",setup(g){const r=p(!0),u=p([]),t=p(""),d=p(!1);U();const a=k(()=>{const s=D(u.value);return Object.keys(s).length>0&&(console.log("标签数据已生成，共有标签:",Object.keys(s).length),Object.keys(s).forEach(e=>{console.log(`- ${e}: ${s[e].length}篇文章`)})),s});k(()=>u.value.sort((s,e)=>e.date.time-s.date.time));function S(){d.value=!d.value}function P(s){if(console.log("切换标签:",s,"当前选中:",t.value),t.value===s?t.value="":(t.value=s,a.value[s]?console.log(`选中标签 ${s} 下有 ${a.value[s].length} 篇文章`):console.warn(`标签 ${s} 在数据中不存在!`)),typeof window<"u"){const e=new URL(window.location.href);t.value?e.searchParams.set("tag",t.value):e.searchParams.delete("tag"),window.history.replaceState({},"",e.toString())}}function m(s){const e=s.detail;console.log("TagsView收到标签选择事件:",e),e&&typeof e=="string"&&z(()=>{if(t.value===e){if(t.value="",console.log("取消选中标签:",e),typeof window<"u"){const i=new URL(window.location.href);i.searchParams.delete("tag"),window.history.replaceState({},"",i.toString())}}else if(t.value=e,a.value[e]?console.log(`通过事件选中标签 ${e} 下有 ${a.value[e].length} 篇文章`):console.warn(`事件选中的标签 ${e} 在数据中不存在!`),typeof window<"u"){const i=new URL(window.location.href);i.searchParams.set("tag",e),window.history.replaceState({},"",i.toString())}})}return C(async()=>{try{if(console.log("TagsView组件已挂载"),typeof window<"u"&&window.addEventListener("tag-selected",m),u.value=I,console.log("加载的博客文章数量:",u.value.length),typeof window<"u"){const e=new URLSearchParams(window.location.search).get("tag");console.log("URL中的标签参数:",e),e?setTimeout(()=>{t.value=e,console.log("从URL设置选中标签:",t.value),a.value[e]?console.log(`URL选中标签 ${e} 下有 ${a.value[e].length} 篇文章`):console.warn(`URL选中的标签 ${e} 在数据中不存在!`)},100):(t.value="",console.log("默认不选择任何标签，显示所有文章"))}}catch(s){console.error("加载博客文章失败:",s)}finally{r.value=!1}}),E(()=>{typeof window<"u"&&window.removeEventListener("tag-selected",m)}),V(t,s=>{if(console.log("selectTag变化:",s),s&&a.value[s]){const e=a.value[s].length;console.log(`当前选中标签 ${s} 下有 ${e} 篇文章`)}}),(s,e)=>r.value?(n(),l("div",G,e[0]||(e[0]=[o("div",{class:"loading-spinner"},null,-1),o("span",null,"加载中...",-1)]))):Object.keys(a.value).length===0?(n(),l("div",M,"暂无标签")):(n(),l("div",Y,[o("div",A,[o("div",{class:$(["tags",{expanded:d.value}])},[(n(!0),l(h,null,w(a.value,(i,c)=>(n(),j(q,{key:c,tag:c,count:i.length,"is-active":t.value===c,onClick:f=>P(c)},null,8,["tag","count","is-active","onClick"]))),128))],2),o("div",{class:"expand-button",onClick:S},[o("span",{class:$(["expand-icon",{expanded:d.value}])},"^",2)])]),e[4]||(e[4]=o("div",{class:"content-divider"},null,-1)),B(N,{name:"fade",mode:"out-in"},{default:O(()=>[t.value&&a.value[t.value]?(n(),l("div",{key:t.value,class:"content-wrapper"},[o("div",H,[_(v(t.value)+" ",1),o("span",J,"("+v(a.value[t.value].length)+")",1)]),o("div",K,[(n(!0),l(h,null,w(a.value[t.value],(i,c)=>(n(),l("a",{href:b(L)(i.url),key:c,class:"posts",style:x({"--index":c})},[o("div",W,[e[1]||(e[1]=o("div",{class:"post-dot"},null,-1)),_(" "+v(i.title),1)]),o("div",X,v(i.date.string),1)],12,Q))),128)),a.value[t.value].length===0?(n(),l("div",Z," 该标签下暂无文章 ")):T("",!0),e[2]||(e[2]=o("div",{class:"posts-fade-bottom"},null,-1))])])):(n(),l("div",ee,[o("div",se,[(n(!0),l(h,null,w(a.value,(i,c)=>(n(),l("div",{key:c,class:"tag-group"},[o("div",te,v(c),1),o("div",oe,[(n(!0),l(h,null,w(i,(f,y)=>(n(),l("a",{href:b(L)(f.url),key:y,class:"posts",style:x({"--index":y})},[o("div",ne,[e[3]||(e[3]=o("div",{class:"post-dot"},null,-1)),_(" "+v(f.title),1)]),o("div",le,v(f.date.string),1)],12,ae))),128))])]))),128)),Object.keys(a.value).length===0?(n(),l("div",ie," 暂无文章 ")):T("",!0)])]))]),_:1})]))}}),ue=F(ce,[["__scopeId","data-v-95ab3cbd"]]);export{ue as T};
